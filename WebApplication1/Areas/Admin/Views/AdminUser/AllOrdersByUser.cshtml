@using MotoCross.Json;
@using Domain.Models.ViewModel;
@model OrderViewModel;



<table class="table " style="position: relative; border-collapse: collapse;">
    <thead class="thead_orders" style="position: sticky; top: 0; background: beige; border: 0;">

        <tr class="tr_orders fixed" style="box-shadow: 0px 1px 0px 0px #040404; top: 0;">
            <th style="border: 0;">Дата </th>
            <th style="border: 0;">Наименование</th>
            <th style="border: 0;">Цена</th>
            <th style="border: 0;">Статус</th>

        </tr>
    </thead>
    <tbody class="scroll">
        @foreach (var order in Model.Orders)
        {
            <tr class="tr_orders">

                <td>@order.Data.ToString("dd.MM.yyyy") </td>
                <td>@order.Name</td>
                <td>@order.Price.ToString("C")</td>
                <td>
                    @if (!order.AdminOrderConfirmed)
                    {
                        <button class="button_on_personal_area" onclick="myFunction1(@order.Id)">Подвердить</button>
                    }
                    else
                    {
                        <button class="button_on_personal_area" onclick="myFunction1(@order.Id)" disabled>Подвердить</button>
                    }

                </td>
            </tr>
        }
    </tbody>
</table>
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script><!-- Модальное окно -->

<script>
    function myFunction1(orderid)
    {

        if (orderid === null) {
            alert('id заказа null');
            console.log(1);
            return;
        }

        console.log('zhopa');
        var url = "@Url.Action("AdminConfirmedOrders", "AdminUser")" + "?orderId=" + orderid;
        console.log(url);
        $.ajax({
            url: url,
            dataType: 'json',
            type: "post",
            async: true,
            success: function (response) {
                console.log(response);
                switch (response.status) {
                    case parseInt('@((int)JsonResponseStatuses.Ok)'): {
                        location.reload();
                        break;
                    }

                    case parseInt('@((int)JsonResponseStatuses.NotFound)'): {
                        alert(response.message);
                        break;
                    }
                    case parseInt('@((int)JsonResponseStatuses.Error)'): {
                        alert("Ошибка подверждения заказа!");
                        break;
                    }
                }


            }
        });
    }
</script>